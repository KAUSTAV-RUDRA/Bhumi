<!DOCTYPE html>
<html>
<head>
  <title>Manager Dashboard</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body { background-color: #f9f9f9; }
    .section-box { background: white; border-radius: 10px; padding: 20px; margin-bottom: 30px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h2 { margin-bottom: 20px; }
  </style>
</head>
<body>
  <div class="container mt-5">
    <h1 class="mb-4">üë®‚Äçüíº Welcome, Manager</h1>

    <!-- Section: Create Teacher -->
    <div class="section-box">
      <h2>Create Teacher Profile</h2>
      <form method="POST" action="/create-teacher/">
        {% csrf_token %}
        <div class="mb-3">
          <label class="form-label">Full Name</label>
          <input type="text" name="name" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Email</label>
          <input type="email" name="email" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Password</label>
          <input type="password" name="password" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Assign Area</label>
          <input type="text" name="area" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-primary">Create Teacher</button>
      </form>
    </div>

    <!-- Section: Manage Teacher Permissions -->
    <div class="section-box">
      <h2>Manage Teacher Permissions</h2>
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Area</th>
            <th>Can Upload Bills</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for teacher in teachers %}
          <tr>
            <td>{{ teacher.username }}</td>
            <td>{{ teacher.email }}</td>
            <td>{{ teacher.area }}</td>
            <td>{{ teacher.can_upload_bills }}</td>
            <td>
              <form method="POST" action="/toggle-permission/{{ teacher.id }}/">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm btn-warning">Toggle Permission</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Section: Bills Submitted by Teachers -->
    <div class="section-box">
      <h2>Submitted Bills</h2>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Teacher</th>
            <th>Type</th>
            <th>Amount</th>
            <th>Month</th>
            <th>Submitted On</th>
          </tr>
        </thead>
        <tbody>
          {% for bill in bills %}
          <tr>
            <td>{{ bill.teacher.username }}</td>
            <td>{{ bill.type }}</td>
            <td>‚Çπ{{ bill.amount }}</td>
            <td>{{ bill.month }}</td>
            <td>{{ bill.submitted_at }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="section-box">
  <h2>üìä Monthly Expense Overview</h2>
  <canvas id="billChart" height="100"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<canvas id="billChart" height="100"></canvas>
<script>
  const ctx = document.getElementById('billChart').getContext('2d');
  const billChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: {{ chart_labels|safe }},
      datasets: [{
        label: 'Amount Spent (INR)',
        data: {{ chart_data|safe }},
        backgroundColor: 'rgba(54, 162, 235, 0.6)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true,
          title: {
            display: true,
            text: 'Rupees'
          }
        }
      }
    }
  });
</script>


    <a href="/logout" class="btn btn-danger">Logout</a>
  </div>
</body>
</html>
